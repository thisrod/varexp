\input a4
\input xpmath
\input respnotes

\title{The instability of variational quantum mechanics with Gaussian approximants is (not) entirely due to the unstable least squares problem}

Coherent states have been considered as an approximant for variational quantum mechanics since 197?.  Superpositions of them are an obvious way to extend the approximant, so that the variational dynamics converge to Hamiltonian evolution.  However, these dynamics are numerically unstable, and it has not been possible to increase the size of the superposition to see this convergence.  The coherent states are overcomplete, and it has often been suggested that this instability is due to the variational problem being underdetermined.

A numerical experiment was carried out to test this hypothesis.  The dynamics of a Morse oscillator were computed by three different methods.  First, a harmonic potential was fit to the bottom of the Morse potential, the state and the Hamiltonian were expanded over its eigenstates, and Schrödinger's equation was integrated directly in Hilbert space.  Secondly, differential equations were derived for the variational parameters in the standard way, using the normal equations of the regularised variational problem, and these were solved in parameter space.  The third method was intermediate: Schrödinger's equation was solved in Hilbert space, but the state was approximated by a superposition of coherent states, updated by least squares at each timestep.  Finally, the eigenstates of this potential are known exactly, and the state was expanded over those.

In a sense, expanding over Fock states is cheating.  If it were practical to do this, there would be no point using a variational method: these would be employed in many-particle problems, where an orthonormal basis would be unmanagably large.  In principle, the operations required for the second and third methods could be performed on the superpositions of coherent states, using the normal equations, without projection on an orthonormal basis; in a many-particle problem, they would have to be.  However, this would raise the question whether those least-square solutions from the normal equations were stable.  By using an orthonormal basis, we can be more confident of this.

A few different ODE solving algorithms were used, with different tolerance for stiff ODEs.  Adaptive 4th/5th order Runge-Kutta was used.  This is the algorithm that everyone will try by default, and it would be useful to know if it performs much worse than other algorithms.  ? and ? were used for comparison.  These discretisations have very different regions of stability ...

The solutions from method 3 provide a test of the stiffness of the ODEs defined in parameter space by the least squares problem.  The step in Hilbert space is very nearly the same from one time step to the next.  If the step in parameter space changes dramatically, this would suggest that the variational solution is very sensitive to the state, and thus to some of the parameters.  This would indicate that the ODEs are stiff.

The initial state was the ground state of the Morse oscillator potential, given various momentum kicks.  The number of components in the superposition representing this was varied.  The initial superposition was found by the AMPL optimisation program, with the constraint that no component would have a weight less that ?.

I want to measure the numerical stability of the variational dynamics derived from Schrödinger's equation.  I can do that by measuring how the discretisation error converges as the timestep is reduced.  The second hypothesis is that the instability is due to stiffness, which can be tested by discretising time in ways with a variety of stability regions, and seeing whether the stability differs.

The first attempt at this will compute the dynamics of a quartic oscillator, with Hamiltonian 
$$H=\hbar a^{2\dagger}a².$$
It will do so by the midpoint method, discretising the differential equation
$$Du(t)=f(t)$$
to the difference equation
$$v^{n+1}=v^{n-1}+2τfⁿ,$$
where $tⁿ=nτ$, $vⁿ$ is meant to approximate $u(tⁿ)$, and $fⁿ=f(vⁿ)$.  The results will be compared for three difference choices of $v$ and $f$.

In the first choice, the quantum state at time $t$ is expanded over a truncated Fock basis $|N〉$, as 
$$|ν(c(t))〉=|N〉c(t).$$
Schrödinger's equation expands to
$$|N〉Dc(t)=|D(ν\circ c)(t)〉≈{H\over i\hbar}|ν(c(t))〉≈|N〉〈N|{H\over i\hbar}|N〉c(t),$$
whence
$$Dc(t)≈〈N|{H\over i\hbar}|N〉c(t).$$
In this method, we set
$$vⁿ=cⁿ\qquad{\rm and}\qquad fⁿ=〈N|{H\over i\hbar}|N〉c(t),$$
solving Schrödinger's equation quite conventionally.

In the second choice, the state is approximated as a superposition of coherent states,
$$|ψ(z(t))〉=∑_{φ,α∈z(t)}e^{φ+αa†}|0〉=∑_{φ,α∈z(t)}e^{φ+½|α|²}|α〉.$$
Time is discretised immediately, setting
$$vⁿ=|ψ(zⁿ)〉\qquad{\rm and}\qquad fⁿ={H\over i\hbar}|ψ(zⁿ)〉,$$
so that the midpoint formula becomes
$$|ψ(z^{n+1})〉≈|ψ(z^{n-1})〉+{2τH\over i\hbar}|ψ(zⁿ)〉.$$
The approximation is due to basis truncation, as always in a least squares sense.  Writing the unknown $|ψ(z^{n+1})〉$ in terms of $|Dψ(zⁿ)〉$ and expanding over a Fock basis gives
$$ 〈N|Dψ(zⁿ)〉\bigl(z^{n+1}-zⁿ\bigr)≈〈N|ψ(z^{n-1})〉-〈N|ψ(zⁿ)〉-2iτ〈N|H|ψ(zⁿ)〉.$$
This matrix equation can be solved for $z^{n+1}-zⁿ$, which can be used to update $z$.  

The third choice, the conventional variational one, is to discretise the state first, setting
$$vⁿ=zⁿ\qquad{\rm and}\qquad |Dψ(zⁿ)〉fⁿ≈{H\over i\hbar}|ψ(zⁿ)〉.$$
The midpoint formula is used exactly, and $fⁿ$ satisfies the least squares problem
$$〈N|Dψ(zⁿ)〉fⁿ≈-i〈N|Dψ(zⁿ)〉{H\over \hbar}|ψ(zⁿ)〉.$$
Usually, this would be expanded over $〈Dψ(zⁿ)|$ to give a set of normal equations.  However, when $|Dψ(zⁿ)〉$ is near singular, the numerical stability of the normal equations is suspect.  Expanding over an orthonormal basis removes this confounding instability.

To do this, we need some bracket matrices.  We have
$$|Dψ(φ,α)〉=(1,a†)|ψ(φ,α)〉.$$
The brackets with the number states are
$$〈m|H/\hbar|n〉=n(n-1)δ_{mn}$$
and
$$〈n|Dψ(φ,α)〉=e^φ\pmatrix{{α^n\over \sqrt{n!}} &  α^{n-1}\sqrt{n\over (n-1)!}},$$
as is the bracket of the quartic oscillator Hamiltonian $a^{2\dagger}a²$
$$〈n|H/\hbar|ψ(φ,α)〉=e^φα^n\sqrt{n(n-1)\over(n-2)!}.$$


\bye