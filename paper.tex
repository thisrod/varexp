\input a4
\input xpmath
\input respnotes

\title{Stability of variational quantum dynamics with Gaussian approximants}

Coherent states have been considered as an approximant for variational quantum mechanics since 197?.  Superpositions of them are an obvious way to extend the approximant, so that the variational dynamics converge to Hamiltonian evolution.  However, these dynamics are numerically unstable, and it has not been possible to increase the size of the superposition to see this convergence.  The coherent states are overcomplete, and it has often been suggested that this instability is due to the variational problem being underdetermined.

A numerical experiment was carried out to test this hypothesis.  The dynamics of a quartic oscillator were computed by three different methods.  First, a harmonic potential was fit to the bottom of the Morse potential, the state and the Hamiltonian were expanded over its eigenstates, and Schrödinger's equation was integrated directly in Hilbert space.  Secondly, differential equations were derived for the variational parameters in the standard way, using the normal equations of the regularised variational problem, and these were solved in parameter space.  The third method was intermediate: Schrödinger's equation was solved in Hilbert space, but the state was approximated by a superposition of coherent states, updated by least squares at each timestep.  Finally, the eigenstates of this potential are known exactly: the state was expanded over them, and the exact dynamics calculated for comparison.

In a sense, expanding over Fock states is cheating.  If it were practical to do this, there would be no point using a variational method: these would be employed in many-particle problems, where an orthonormal basis such as the Fock states would be unmanagably large.  In principle, the operations required for the second and third methods could be performed on the superpositions of coherent states, using the normal equations, without projection on an orthonormal basis; in a many-particle problem, they would have to be.  However, this would raise the question whether those least-square solutions from the normal equations were stable.  By using an orthonormal basis, we can be more confident of this.

I used three discretisation formulae for ODE, with different regions of stability.  As a first step, the Hamiltonian and a coherent state with real amplitude 2 was expanded over Fock states $|0〉$ through $|10〉$, and the resulting equations for the components solved directly.  The Hamiltonian is
$$H=\hbar a^{2\dagger}a²,$$
so the Fock states are eigenstates, although the spacing of their energies is uneven.  The quantum state at time $t$ was expanded over a truncated Fock basis $|N〉=\pmatrix{|1\rangle & |2\rangle & ⋯ & |N\rangle}$, with a column vector of coefficients $c(t)$, as
$$|ν(c(t))〉=|N〉c(t).$$
Schrödinger's equation expands to
$$|N〉Dc(t)=|D(ν\circ c)(t)〉={H\over i\hbar}|ν(c(t))〉=|N〉〈N|{H\over i\hbar}|N〉c(t),$$
whence
$$Dc(t)=-i〈N|{H\over \hbar}|N〉c(t).$$
Usually, these expansions would be approximate due to basis truncation.  In this case, the Fock states diagonalise $H$, so they are exact.  However, in general the initial state can only be approximately expanded over $|N\rangle$.  Time was discretised with the explicit Euler formula, which replaces the differential equation
$$Du(t)=f(u(t))$$
with a difference equation
$$v^{n+1}=vⁿ+τfⁿ,$$
where $tⁿ=nτ$, $vⁿ$ is meant to approximate $u(tⁿ)$, and $fⁿ=f(vⁿ)$.  Let
$$vⁿ=cⁿ\qquad{\rm and}\qquad fⁿ=-i〈N|{H\over\hbar}|N〉c(t).$$
Since $〈N|H|N〉$ is diagonal, the matrix product can be performed sparely as a dot product.  The results are shown below.  The Fock states are eigenstates of the Hamiltonian, so their amplitudes should be constant: in the exact solution of Schrödinger's equation, all the ratios plotted are exactly 1.

%\centerline{\XeTeXpicfile dry.pdf width \hsize}

These results are the textbook signs of stiffness.  As the time step is reduced from values on the order of 1, the discretised solutions diverge hugely, before converging at very small time steps.  In the standard theory of discrete approximations to $Du(t)=f(u(t))$, stability is determined by the eigenvalues of the linear transform $Df$.  In Schrödinger's equation, $f$ is the Hamiltonian, a linear transform, so in our expansion, $df=f=-i〈N|H/\hbar|N〉$, and the relevant eigenvalues are $-iEⁿ/\hbar=-in(n-1)$.  The stiffness of a differential equation is often measured by the ratio of the sizes of these eigenvalues.  For the quartic oscillator, some eigenvalues are zero, so this is not a sensible measure.  However, the largest eigenvalue, which often determines the timestep, increases quadratically with the size of the Fock basis as $N(N-1)$.

The stability region of the explicit Euler formula is the disk $|\bar k-(-1)|≤1|$.  So it is unstable for any Jacobian with complex eigenvalues, which is certainly the case for a Hamiltonian.  The implicit Euler formula, 
$$v^{n+1}=vⁿ+τf^{n+1},$$
has the opposite stability region.  For the oscillator, this becomes
$$c^{n+1}=cⁿ-iτ〈N|{H\over\hbar}|N〉c^{n+1},$$
so $c^{n+1}$ satisfies the linear equation
$$(1+iτ〈N|{H\over\hbar}|N〉)c^{n+1}=cⁿ.$$
This is still diagonal for the quartic oscillator.  To order $τ$, the implicitn formula is the same as the explicit one.  Obviously the higher powers of $τ$ make the difference when $τ$ is finite.

The results of the backward Euler formula are the opposite of the Euler formula.  Instead of increasing, the amplitudes of the larger number states decrease nearly to zero.  This distorts the trajectory of $〈a(t)〉$, as show below.

A third method is the semi-implicit one, with the formulae
$$v^{\prime n}=vⁿ+½τf^{\prime n}\qquad v^{n+1}=vⁿ+τf^{\prime n}.$$
With the Hamiltonian, this becomes
$$c^{n+1}=cⁿ-iτH\biggl(1+{iτ\over 2}H\biggr)^{-1}cⁿ.$$
If Hilbert space is considered as a real vector space, complex multiples of the eigenstates of the Hamiltonian form planes instead of lines.  The eigenstates evolve as $e^{iωt}$, so, when the dynamics are projected onto an eigenplane, the state traces out a circle, with radius equal to the absolute value of the the coefficient of the eigenstate when the initial state is expanded.  Different eigenstates circle the origin with different frequencies.

The semi-implicit formula has a special property: when the trajectory of $u(t)$ is a circle, the $vⁿ$ lie exactly on that circle, and the discretisation error is equivalent to rescaling time by a factor that depends on the frequency and the discrete timestep.  In Hilbert space, this means that the projections of the state onto eigenplanes still circle the origin exactly: only the frequencies are altered by discretisation.  So the effect of discretising quantum dynamics using the semi-implicit formula is merely to shift the energies of the eigenstates.  Of course, this can be a significant effect: it's the only difference between the harmonic and quartic oscillators.

The solutions from method 3 provide a test of the stiffness of the ODEs defined in parameter space by the least squares problem.  The step in Hilbert space is very nearly the same from one time step to the next.  If the step in parameter space changes dramatically, this would suggest that the variational solution is very sensitive to the state, and thus to some of the parameters.  This would indicate that the ODEs are stiff.

The initial state was the ground state of the Morse oscillator potential, given various momentum kicks.  The number of components in the superposition representing this was varied.  The initial superposition was found by the AMPL optimisation program, with the constraint that no component would have a weight less that ?.

I want to measure the numerical stability of the variational dynamics derived from Schrödinger's equation.  I can do that by measuring how the discretisation error converges as the timestep is reduced.  The second hypothesis is that the instability is due to stiffness, which can be tested by discretising time in ways with a variety of stability regions, and seeing whether the stability differs.

In the second choice, the state is approximated as a superposition of coherent states,
$$|ψ(z(t))〉=∑_{φ,α∈z(t)}e^{φ+αa†}|0〉=∑_{φ,α∈z(t)}e^{φ+½|α|²}|α〉.$$
Time is discretised immediately, setting
$$vⁿ=|ψ(zⁿ)〉\qquad{\rm and}\qquad fⁿ={H\over i\hbar}|ψ(zⁿ)〉,$$
so that the midpoint formula becomes
$$|ψ(z^{n+1})〉≈|ψ(z^{n-1})〉+{2τH\over i\hbar}|ψ(zⁿ)〉.$$
The approximation is due to basis truncation, as always in a least squares sense.  Writing the unknown $|ψ(z^{n+1})〉$ in terms of $|Dψ(zⁿ)〉$ and expanding over a Fock basis gives
$$ 〈N|Dψ(zⁿ)〉\bigl(z^{n+1}-zⁿ\bigr)≈〈N|ψ(z^{n-1})〉-〈N|ψ(zⁿ)〉-2iτ〈N|H|ψ(zⁿ)〉.$$
This matrix equation can be solved for $z^{n+1}-zⁿ$, which can be used to update $z$.  

The third choice, the conventional variational one, is to discretise the state first, setting
$$vⁿ=zⁿ\qquad{\rm and}\qquad |Dψ(zⁿ)〉fⁿ≈{H\over i\hbar}|ψ(zⁿ)〉.$$
The midpoint formula is used exactly, and $fⁿ$ satisfies the least squares problem
$$〈N|Dψ(zⁿ)〉fⁿ≈-i〈N|Dψ(zⁿ)〉{H\over \hbar}|ψ(zⁿ)〉.$$
Usually, this would be expanded over $〈Dψ(zⁿ)|$ to give a set of normal equations.  However, when $|Dψ(zⁿ)〉$ is near singular, the numerical stability of the normal equations is suspect.  Expanding over an orthonormal basis removes this confounding instability.

To do this, we need some bracket matrices.  We have
$$|Dψ(φ,α)〉=(1,a†)|ψ(φ,α)〉.$$
The brackets with the number states are
$$〈m|H/\hbar|n〉=n(n-1)δ_{mn}$$
and
$$〈n|Dψ(φ,α)〉=e^φ\pmatrix{{α^n\over \sqrt{n!}} &  α^{n-1}\sqrt{n\over (n-1)!}},$$
as is the bracket of the quartic oscillator Hamiltonian $a^{2\dagger}a²$
$$〈n|H/\hbar|ψ(φ,α)〉=e^φα^n\sqrt{n(n-1)\over(n-2)!}.$$


\bye